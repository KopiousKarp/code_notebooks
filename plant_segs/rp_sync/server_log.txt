2024-08-28 20:34:48.680696|1724877288.6807122|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:49.722741|1724877289.7227504|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:50.767178|1724877290.7671876|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:51.815881|1724877291.8158894|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:52.863017|1724877292.8630261|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:53.910226|1724877293.910235|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:54.957589|1724877294.9575982|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:56.002119|1724877296.0021281|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:57.047620|1724877297.0476284|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:58.092859|1724877298.0928676|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:34:59.137569|1724877299.137579|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:00.183388|1724877300.1833978|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:01.228400|1724877301.228409|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:02.273198|1724877302.2732072|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:03.319117|1724877303.3191252|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:04.364757|1724877304.364766|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:05.409472|1724877305.4094813|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:06.453761|1724877306.45377|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:07.500025|1724877307.500035|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:08.546166|1724877308.546179|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:09.591875|1724877309.591885|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:10.637294|1724877310.6373022|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:11.682236|1724877311.6822448|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:12.727606|1724877312.7276173|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:13.772902|1724877313.7729108|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:14.818245|1724877314.818254|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:15.863368|1724877315.8633776|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:16.907536|1724877316.9075453|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:17.953354|1724877317.9533625|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:18.997197|1724877318.9972057|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:20.041958|1724877320.0419664|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:21.087168|1724877321.087182|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:22.130567|1724877322.1305754|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:23.175566|1724877323.1755753|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:24.220195|1724877324.220204|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:25.264327|1724877325.264336|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:26.308879|1724877326.3088877|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:27.354435|1724877327.3544443|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:28.397621|1724877328.397631|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:29.442439|1724877329.4424477|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:30.486890|1724877330.4868991|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:31.531633|1724877331.5316412|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:32.577014|1724877332.5770228|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:33.622988|1724877333.6229968|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:34.668466|1724877334.6684754|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:35.713363|1724877335.7133722|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:36.759916|1724877336.7599244|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:37.804869|1724877337.8048778|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:38.850193|1724877338.8502018|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:39.894335|1724877339.8943443|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:40.938773|1724877340.9387817|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:41.985400|1724877341.9854093|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:43.030562|1724877343.0305705|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:44.074893|1724877344.074902|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:45.121546|1724877345.121555|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:46.168269|1724877346.1682785|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-08-28 20:35:47.213485|1724877347.213494|Exception parsing instruction,Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).,Traceback (most recent call last):
  File "/opt/root_painter/trainer/model_utils.py", line 63, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNetGNRes:
	Missing key(s) in state_dict: "conv_in.0.weight", "conv_in.0.bias", "conv_in.2.weight", "conv_in.2.bias", "conv_in.3.weight", "conv_in.3.bias", "conv_in.5.weight", "conv_in.5.bias", "down1.conv1.0.weight", "down1.conv1.0.bias", "down1.conv1.2.weight", "down1.conv1.2.bias", "down1.conv2.0.weight", "down1.conv2.0.bias", "down1.conv2.2.weight", "down1.conv2.2.bias", "down1.conv1x1.0.weight", "down2.conv1.0.weight", "down2.conv1.0.bias", "down2.conv1.2.weight", "down2.conv1.2.bias", "down2.conv2.0.weight", "down2.conv2.0.bias", "down2.conv2.2.weight", "down2.conv2.2.bias", "down2.conv1x1.0.weight", "down3.conv1.0.weight", "down3.conv1.0.bias", "down3.conv1.2.weight", "down3.conv1.2.bias", "down3.conv2.0.weight", "down3.conv2.0.bias", "down3.conv2.2.weight", "down3.conv2.2.bias", "down3.conv1x1.0.weight", "down4.conv1.0.weight", "down4.conv1.0.bias", "down4.conv1.2.weight", "down4.conv1.2.bias", "down4.conv2.0.weight", "down4.conv2.0.bias", "down4.conv2.2.weight", "down4.conv2.2.bias", "down4.conv1x1.0.weight", "up1.conv1.0.weight", "up1.conv1.0.bias", "up1.conv1.2.weight", "up1.conv1.2.bias", "up1.conv2.0.weight", "up1.conv2.0.bias", "up1.conv2.2.weight", "up1.conv2.2.bias", "up1.conv3.0.weight", "up1.conv3.0.bias", "up1.conv3.2.weight", "up1.conv3.2.bias", "up2.conv1.0.weight", "up2.conv1.0.bias", "up2.conv1.2.weight", "up2.conv1.2.bias", "up2.conv2.0.weight", "up2.conv2.0.bias", "up2.conv2.2.weight", "up2.conv2.2.bias", "up2.conv3.0.weight", "up2.conv3.0.bias", "up2.conv3.2.weight", "up2.conv3.2.bias", "up3.conv1.0.weight", "up3.conv1.0.bias", "up3.conv1.2.weight", "up3.conv1.2.bias", "up3.conv2.0.weight", "up3.conv2.0.bias", "up3.conv2.2.weight", "up3.conv2.2.bias", "up3.conv3.0.weight", "up3.conv3.0.bias", "up3.conv3.2.weight", "up3.conv3.2.bias", "up4.conv1.0.weight", "up4.conv1.0.bias", "up4.conv1.2.weight", "up4.conv1.2.bias", "up4.conv2.0.weight", "up4.conv2.0.bias", "up4.conv2.2.weight", "up4.conv2.2.bias", "up4.conv3.0.weight", "up4.conv3.0.bias", "up4.conv3.2.weight", "up4.conv3.2.bias", "conv_out.0.weight", "conv_out.0.bias", "conv_out.2.weight", "conv_out.2.bias". 
	Unexpected key(s) in state_dict: "module.conv_in.0.weight", "module.conv_in.0.bias", "module.conv_in.2.weight", "module.conv_in.2.bias", "module.conv_in.3.weight", "module.conv_in.3.bias", "module.conv_in.5.weight", "module.conv_in.5.bias", "module.down1.conv1.0.weight", "module.down1.conv1.0.bias", "module.down1.conv1.2.weight", "module.down1.conv1.2.bias", "module.down1.conv2.0.weight", "module.down1.conv2.0.bias", "module.down1.conv2.2.weight", "module.down1.conv2.2.bias", "module.down1.conv1x1.0.weight", "module.down2.conv1.0.weight", "module.down2.conv1.0.bias", "module.down2.conv1.2.weight", "module.down2.conv1.2.bias", "module.down2.conv2.0.weight", "module.down2.conv2.0.bias", "module.down2.conv2.2.weight", "module.down2.conv2.2.bias", "module.down2.conv1x1.0.weight", "module.down3.conv1.0.weight", "module.down3.conv1.0.bias", "module.down3.conv1.2.weight", "module.down3.conv1.2.bias", "module.down3.conv2.0.weight", "module.down3.conv2.0.bias", "module.down3.conv2.2.weight", "module.down3.conv2.2.bias", "module.down3.conv1x1.0.weight", "module.down4.conv1.0.weight", "module.down4.conv1.0.bias", "module.down4.conv1.2.weight", "module.down4.conv1.2.bias", "module.down4.conv2.0.weight", "module.down4.conv2.0.bias", "module.down4.conv2.2.weight", "module.down4.conv2.2.bias", "module.down4.conv1x1.0.weight", "module.up1.conv1.0.weight", "module.up1.conv1.0.bias", "module.up1.conv1.2.weight", "module.up1.conv1.2.bias", "module.up1.conv2.0.weight", "module.up1.conv2.0.bias", "module.up1.conv2.2.weight", "module.up1.conv2.2.bias", "module.up1.conv3.0.weight", "module.up1.conv3.0.bias", "module.up1.conv3.2.weight", "module.up1.conv3.2.bias", "module.up2.conv1.0.weight", "module.up2.conv1.0.bias", "module.up2.conv1.2.weight", "module.up2.conv1.2.bias", "module.up2.conv2.0.weight", "module.up2.conv2.0.bias", "module.up2.conv2.2.weight", "module.up2.conv2.2.bias", "module.up2.conv3.0.weight", "module.up2.conv3.0.bias", "module.up2.conv3.2.weight", "module.up2.conv3.2.bias", "module.up3.conv1.0.weight", "module.up3.conv1.0.bias", "module.up3.conv1.2.weight", "module.up3.conv1.2.bias", "module.up3.conv2.0.weight", "module.up3.conv2.0.bias", "module.up3.conv2.2.weight", "module.up3.conv2.2.bias", "module.up3.conv3.0.weight", "module.up3.conv3.0.bias", "module.up3.conv3.2.weight", "module.up3.conv3.2.bias", "module.up4.conv1.0.weight", "module.up4.conv1.0.bias", "module.up4.conv1.2.weight", "module.up4.conv1.2.bias", "module.up4.conv2.0.weight", "module.up4.conv2.0.bias", "module.up4.conv2.2.weight", "module.up4.conv2.2.bias", "module.up4.conv3.0.weight", "module.up4.conv3.0.bias", "module.up4.conv3.2.weight", "module.up4.conv3.2.bias", "module.conv_out.0.weight", "module.conv_out.0.bias", "classes". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 162, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 413, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 471, in segment_file
    seg_out = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 183, in ensemble_segment
    cnn = load_model(model_path)
  File "/opt/root_painter/trainer/model_utils.py", line 67, in load_model
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2189, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.conv_out.2.weight", "module.conv_out.2.bias". 
	Unexpected key(s) in state_dict: "classes". 
	size mismatch for module.conv_out.0.weight: copying a param with shape torch.Size([8, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
	size mismatch for module.conv_out.0.bias: copying a param with shape torch.Size([8]) from checkpoint, the shape in current model is torch.Size([2]).

2024-09-03 18:28:38.965849|1725388118.96586|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 24.00 MiB is free. Of the allocated memory 7.93 GiB is allocated by PyTorch, and 48.94 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 101, in forward
    out = cropped + out # residual
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 24.00 MiB is free. Of the allocated memory 7.93 GiB is allocated by PyTorch, and 48.94 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:39.007330|1725388119.0073385|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 4.19 GiB is allocated by PyTorch, and 48.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 4.19 GiB is allocated by PyTorch, and 48.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:39.008667|1725388119.008674|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.99 GiB is allocated by PyTorch, and 36.93 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.99 GiB is allocated by PyTorch, and 36.93 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:40.132421|1725388120.1324513|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:40.147082|1725388120.1470923|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:40.499713|1725388120.499722|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 270.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 270.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:41.237667|1725388121.2376823|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:41.251604|1725388121.2516139|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 2.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:41.698417|1725388121.6984258|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 239.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 239.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:42.326528|1725388122.3265426|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:42.362059|1725388122.3620696|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:42.854735|1725388122.854743|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:43.426061|1725388123.426071|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:43.457647|1725388123.4576578|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:44.019343|1725388124.0193527|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:44.523738|1725388124.5237498|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:44.557173|1725388124.5571837|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:45.179365|1725388125.179373|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:45.624714|1725388125.624724|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:45.653595|1725388125.6536057|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:46.336919|1725388126.3369274|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:46.721350|1725388126.7213612|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:46.758100|1725388126.7581124|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:47.497436|1725388127.4974444|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:47.819169|1725388127.8191803|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:47.854327|1725388127.8543384|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:48.657797|1725388128.6578057|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:48.917025|1725388128.9170349|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:48.955485|1725388128.9554985|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:49.818669|1725388129.818678|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:50.009351|1725388130.0093598|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:50.050392|1725388130.0504017|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:50.983394|1725388130.9834032|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:51.107004|1725388131.1070154|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:51.146636|1725388131.146647|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:52.141318|1725388132.1413262|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:52.208916|1725388132.208925|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:52.251943|1725388132.2519548|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:53.301422|1725388133.3014333|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:53.312819|1725388133.31283|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:53.361006|1725388133.3610194|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:54.422357|1725388134.422371|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:54.480423|1725388134.4804332|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:54.546884|1725388134.5468903|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:55.517640|1725388135.517649|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:55.579767|1725388135.5797772|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:55.721442|1725388135.7214477|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:56.611809|1725388136.6118183|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:56.673244|1725388136.6732547|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:56.885821|1725388136.8858292|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:57.706731|1725388137.7067413|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:57.767237|1725388137.767248|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:58.045028|1725388138.0450363|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:58.798373|1725388138.7983823|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:58.859038|1725388138.8590553|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 948, in forward
    return F.conv_transpose2d(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 2.98 GiB is allocated by PyTorch, and 102.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:59.207224|1725388139.2072322|Exception parsing instruction,HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 99, in forward
    out = self.conv1(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 250.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 7.68 GiB is allocated by PyTorch, and 238.40 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:28:59.891353|1725388139.8913622|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 34.00 MiB is free. Of the allocated memory 3.95 GiB is allocated by PyTorch, and 295.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:01.699213|1725388141.6992218|Exception parsing instruction,HIP out of memory. Tried to allocate 554.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 490.00 MiB is free. Of the allocated memory 5.40 GiB is allocated by PyTorch, and 108.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 102, in forward
    out = self.conv2(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 554.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 490.00 MiB is free. Of the allocated memory 5.40 GiB is allocated by PyTorch, and 108.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:02.910234|1725388142.9102426|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:04.204975|1725388144.2049892|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:05.523377|1725388145.5233853|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:06.852289|1725388146.8522983|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:08.032198|1725388148.0322058|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:09.235330|1725388149.23534|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:10.417327|1725388150.4173348|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:11.651773|1725388151.6517782|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:12.823703|1725388152.8237114|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:14.035166|1725388154.0351744|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:15.270391|1725388155.2703993|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:16.425574|1725388156.4255824|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:17.559407|1725388157.5594156|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:18.733840|1725388158.733851|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:19.945053|1725388159.9450648|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:21.087196|1725388161.0872047|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:22.247020|1725388162.2470303|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:23.449576|1725388163.4495845|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:24.670412|1725388164.67042|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:25.838793|1725388165.8388016|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:26.993081|1725388166.9930894|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:28.176514|1725388168.176522|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:29.389423|1725388169.389431|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:30.551581|1725388170.5515904|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:29:31.673563|1725388171.6735716|Exception parsing instruction,HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 57, in forward
    out1 = self.pool(x)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 164, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/_jit_internal.py", line 503, in fn
    return if_false(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 796, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 80.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 0 bytes is free. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 302.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:39.419276|1725388359.4192855|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 98.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 128.81 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 255, in ensemble_segment
    flipped_pred_maps = unet_segment(cnn, flipped_im, bs, in_w,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 98.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 128.81 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:39.582836|1725388359.5828466|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 192.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 307.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 192.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 307.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:40.611031|1725388360.611042|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:40.736951|1725388360.7369602|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:41.768935|1725388361.768943|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:41.884057|1725388361.8840673|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:42.927816|1725388362.9278247|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:43.033722|1725388363.033732|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:44.086527|1725388364.0865352|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:44.183897|1725388364.1839051|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:45.246611|1725388365.2466261|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:45.333505|1725388365.333514|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:46.406951|1725388366.4069605|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:46.493742|1725388366.49375|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:47.567169|1725388367.5671794|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:47.653951|1725388367.6539602|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:48.726372|1725388368.7263808|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:48.813465|1725388368.8134732|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:49.884675|1725388369.8846827|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:49.971719|1725388369.9717283|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:51.044133|1725388371.0441396|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:51.130966|1725388371.130975|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:52.205585|1725388372.2055979|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:52.292268|1725388372.2922761|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:53.363531|1725388373.3635397|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:53.450279|1725388373.4502873|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:54.523472|1725388374.5234818|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:54.610305|1725388374.6103132|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:55.682854|1725388375.6828635|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:55.769588|1725388375.7695987|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:56.841924|1725388376.8419335|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:56.928772|1725388376.928782|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:58.001630|1725388378.0016384|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:58.087987|1725388378.0879955|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:59.161104|1725388379.1611142|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:32:59.247804|1725388379.2478118|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:00.320587|1725388380.3205955|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:00.408066|1725388380.4080753|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:01.480788|1725388381.4807994|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:01.567959|1725388381.5679672|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:02.640489|1725388382.6404974|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:02.726884|1725388382.7268927|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:03.800139|1725388383.8001492|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:03.886819|1725388383.8868313|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:04.959715|1725388384.9597235|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:05.046236|1725388385.0462458|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:06.117320|1725388386.1173296|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:06.204224|1725388386.2042341|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:07.277412|1725388387.2774208|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:07.364204|1725388387.364216|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:08.437388|1725388388.4373984|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:08.524018|1725388388.5240266|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:09.597607|1725388389.5976162|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:09.684553|1725388389.6845615|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:10.757534|1725388390.7575436|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:10.844129|1725388390.844137|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:11.917031|1725388391.917039|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:12.003830|1725388392.0038362|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:13.078221|1725388393.0782306|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:13.164913|1725388393.1649213|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:14.235062|1725388394.2350724|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:14.321732|1725388394.3217404|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:33:15.398345|1725388395.398355|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 46.00 MiB is free. Of the allocated memory 6.25 GiB is allocated by PyTorch, and 275.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:40.669245|1725389560.6692553|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 30.00 MiB is free. Of the allocated memory 6.41 GiB is allocated by PyTorch, and 45.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 30.00 MiB is free. Of the allocated memory 6.41 GiB is allocated by PyTorch, and 45.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:40.822452|1725389560.8224614|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 307.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 307.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:41.815761|1725389561.8157704|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:41.966020|1725389561.9660285|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:42.959675|1725389562.9596834|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:43.114273|1725389563.114282|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:44.104673|1725389564.1046827|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:44.261525|1725389564.2615345|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:45.251339|1725389565.2513452|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:45.407736|1725389565.4077437|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:46.396081|1725389566.3960896|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:46.553832|1725389566.5538406|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:47.542130|1725389567.5421383|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:47.701834|1725389567.7018425|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:48.686746|1725389568.6867557|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:48.850727|1725389568.8507361|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:49.834278|1725389569.834286|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:49.997538|1725389569.9975464|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:50.975491|1725389570.9754999|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:51.140294|1725389571.1403027|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:52.117048|1725389572.117057|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:52.288638|1725389572.2886457|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:53.264846|1725389573.264856|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:53.435136|1725389573.4351447|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:54.410882|1725389574.4108903|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:54.577790|1725389574.577798|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:55.617771|1725389575.617779|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:55.717804|1725389575.7178135|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:56.766363|1725389576.7663767|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:56.864380|1725389576.864389|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:57.915070|1725389577.915079|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:58.011009|1725389578.0110195|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:59.064196|1725389579.0642042|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:52:59.157641|1725389579.157649|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:00.211861|1725389580.2118778|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:00.303189|1725389580.3031976|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:01.360915|1725389581.3609233|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:01.449780|1725389581.4497879|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:02.510268|1725389582.51028|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:02.595048|1725389582.595059|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:03.660620|1725389583.6606288|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:03.740149|1725389583.7401571|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:04.812277|1725389584.8122876|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:04.892018|1725389584.8920274|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:05.962876|1725389585.9628863|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:06.042194|1725389586.0422015|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:07.114334|1725389587.1143446|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:07.193815|1725389587.193825|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:08.265109|1725389588.2651181|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:08.344794|1725389588.3448021|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:09.416423|1725389589.4164326|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:09.495783|1725389589.4957933|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:10.567488|1725389590.5674965|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:10.646793|1725389590.646801|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:11.719705|1725389591.7197142|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:11.799385|1725389591.7993953|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:12.873275|1725389592.8732836|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:12.953011|1725389592.9530191|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:14.025471|1725389594.0254803|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:14.104943|1725389594.1049519|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:15.178399|1725389595.178408|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:15.257986|1725389595.257994|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:16.328973|1725389596.3289824|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:16.408312|1725389596.4083204|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:17.479902|1725389597.4799109|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:17.559251|1725389597.5592594|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:18.630393|1725389598.6304023|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:18.710172|1725389598.7101803|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:19.780455|1725389599.7804637|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:19.859706|1725389599.8597147|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:20.932755|1725389600.932765|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:21.016256|1725389601.0162644|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:22.083998|1725389602.0840087|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:22.163377|1725389602.1633856|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:23.236748|1725389603.2367573|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:23.316255|1725389603.316265|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:24.387016|1725389604.3870256|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:24.466472|1725389604.4664798|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:25.538140|1725389605.5381489|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:25.617937|1725389605.6179457|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:26.690643|1725389606.6906512|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:26.769817|1725389606.769825|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:27.842523|1725389607.8425326|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:27.921961|1725389607.9219716|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:28.992657|1725389608.9926653|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:29.071940|1725389609.0719483|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:30.143443|1725389610.1434534|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:30.222653|1725389610.222661|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:31.294897|1725389611.2949057|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:31.374618|1725389611.3746264|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:32.447617|1725389612.4476278|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:32.527165|1725389612.5271745|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:33.599622|1725389613.59963|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:33.679366|1725389613.6793733|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:34.751501|1725389614.7515113|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:34.831243|1725389614.8312519|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:35.903966|1725389615.903974|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:35.983240|1725389615.9832487|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:37.056235|1725389617.0562458|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:37.135778|1725389617.1357882|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:38.208642|1725389618.2086506|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:38.288465|1725389618.2884734|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:39.358225|1725389619.358236|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:39.437947|1725389619.4379573|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:40.510482|1725389620.5104904|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:40.589712|1725389620.5897212|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:41.661194|1725389621.6612024|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:41.740468|1725389621.7404785|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:42.811386|1725389622.811395|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:42.890768|1725389622.890776|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:43.962643|1725389623.9626522|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:44.042523|1725389624.0425313|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:45.111815|1725389625.1118252|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:45.191187|1725389625.1911955|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:46.263336|1725389626.2633452|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:46.343075|1725389626.3430836|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:47.414903|1725389627.4149122|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:47.494483|1725389627.4944913|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:48.566954|1725389628.5669713|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:48.646742|1725389628.646751|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:49.718337|1725389629.7183464|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:49.797781|1725389629.7977884|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:50.871188|1725389630.8711967|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:50.950644|1725389630.9506526|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:52.022530|1725389632.0225384|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:52.102275|1725389632.102283|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:53.175005|1725389633.1750138|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:53.254719|1725389633.254728|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:54.327648|1725389634.327657|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:54.407225|1725389634.4072335|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:55.478936|1725389635.4789464|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:55.558819|1725389635.5588288|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:56.630851|1725389636.6308596|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:56.710090|1725389636.710099|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:57.782408|1725389637.782418|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:57.862316|1725389637.8623257|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:58.934842|1725389638.9348512|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:53:59.014365|1725389639.0143726|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:00.085402|1725389640.0854118|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:00.164939|1725389640.164948|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:01.234824|1725389641.2348325|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:01.314319|1725389641.314327|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:02.387211|1725389642.387221|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:02.466933|1725389642.4669416|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:03.535609|1725389643.5356193|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:03.615122|1725389643.6151304|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:04.685793|1725389644.6858048|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:04.765259|1725389644.7652683|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:05.837307|1725389645.837315|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:05.916813|1725389645.9168205|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:06.989714|1725389646.9897234|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:07.069552|1725389647.0695612|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:08.141371|1725389648.14138|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:08.221112|1725389648.2211208|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:09.292030|1725389649.2920525|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:09.371638|1725389649.3716471|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:10.441635|1725389650.4416468|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:10.521265|1725389650.5212731|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:11.593725|1725389651.5937352|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:11.673029|1725389651.673037|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:12.745881|1725389652.7458901|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:12.825547|1725389652.8255546|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:13.897616|1725389653.8976269|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:13.977329|1725389653.9773388|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:15.050472|1725389655.0504804|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:15.129884|1725389655.1298919|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:16.202312|1725389656.2023222|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:16.281701|1725389656.2817123|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:17.354683|1725389657.354691|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:17.434376|1725389657.4343839|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:18.505701|1725389658.5057106|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:18.585203|1725389658.585213|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:19.657370|1725389659.6573792|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:19.737170|1725389659.7371783|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:20.809689|1725389660.8096995|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:20.889167|1725389660.889176|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:21.962120|1725389661.9621284|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:22.041873|1725389662.0418806|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:23.114605|1725389663.1146162|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:23.193881|1725389663.1938908|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:24.267438|1725389664.2674465|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:24.347008|1725389664.3470159|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:25.415902|1725389665.4159145|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:25.495510|1725389665.4955187|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:26.568016|1725389666.5680244|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:26.647725|1725389666.6477332|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:27.718967|1725389667.7189791|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:27.798734|1725389667.7987432|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:28.871733|1725389668.8717422|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:28.951147|1725389668.9511557|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:30.024008|1725389670.0240188|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:30.103493|1725389670.1035025|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:31.174524|1725389671.1745336|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:31.254376|1725389671.2543843|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:32.326976|1725389672.3269863|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:32.406431|1725389672.40644|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:33.479370|1725389673.4793787|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:33.558718|1725389673.5587265|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:34.623168|1725389674.6231778|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:34.704332|1725389674.7043412|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:35.773037|1725389675.7730544|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:35.852638|1725389675.8526459|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:36.923958|1725389676.923969|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:37.003297|1725389677.0033069|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:38.075235|1725389678.0752432|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:38.154865|1725389678.1548727|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:39.228210|1725389679.228221|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:39.307917|1725389679.307927|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:40.380642|1725389680.3806512|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:40.460280|1725389680.460288|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:41.532609|1725389681.5326188|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:41.611913|1725389681.6119215|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:42.684246|1725389682.6842542|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:42.763616|1725389682.763624|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:43.835597|1725389683.8356075|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:43.915112|1725389683.9151225|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:44.985559|1725389684.9855692|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:45.065503|1725389685.065511|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:46.135385|1725389686.1353958|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:46.214928|1725389686.2149374|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:47.286597|1725389687.2866058|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:47.365830|1725389687.365838|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:48.436690|1725389688.4366994|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:48.516161|1725389688.51617|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:49.588323|1725389689.5883312|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:49.667884|1725389689.667892|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:50.740247|1725389690.7402568|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:50.819689|1725389690.8196993|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:51.890864|1725389691.8908732|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:51.970529|1725389691.9705367|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:53.042405|1725389693.042415|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:53.122327|1725389693.1223357|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:54.193104|1725389694.1931129|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:54.272569|1725389694.2725775|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:55.343225|1725389695.343234|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:55.422680|1725389695.4226904|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:56.494291|1725389696.4942994|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:56.573932|1725389696.5739405|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:57.646275|1725389697.6462862|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:57.725563|1725389697.7255723|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:58.798509|1725389698.798518|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:58.878042|1725389698.8780563|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:54:59.949694|1725389699.9497032|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:00.029495|1725389700.0295048|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:01.100008|1725389701.1000168|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:01.179842|1725389701.1798506|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:02.252324|1725389702.2523339|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:02.331891|1725389702.3319018|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:03.404441|1725389703.4044504|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:03.483731|1725389703.4837391|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:04.552665|1725389704.5526764|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:04.632132|1725389704.6321409|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:05.705063|1725389705.705072|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:05.784535|1725389705.7845438|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:06.855196|1725389706.8552063|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:06.934714|1725389706.9347227|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:08.007517|1725389708.0075254|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:08.087088|1725389708.0870967|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:09.157608|1725389709.1576178|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:09.237100|1725389709.2371094|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:10.309746|1725389710.3097541|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:10.389154|1725389710.3891625|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:11.456856|1725389711.4568648|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:11.536459|1725389711.536468|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:12.608351|1725389712.6083605|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:12.688144|1725389712.688152|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:13.760011|1725389713.7600195|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:13.839517|1725389713.8395252|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:14.906650|1725389714.9066606|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:14.986095|1725389714.9861028|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:16.059375|1725389716.0593843|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:16.138886|1725389716.138893|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:17.209062|1725389717.2090743|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:17.288498|1725389717.288506|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:18.356502|1725389718.3565118|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:18.436278|1725389718.436288|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:19.506957|1725389719.5069652|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:19.586207|1725389719.5862153|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:20.656938|1725389720.6569462|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:20.736260|1725389720.7362707|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:21.807830|1725389721.8078382|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:21.887644|1725389721.8876522|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:22.959325|1725389722.9593344|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:23.038902|1725389723.038912|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:24.111332|1725389724.1113408|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:24.190807|1725389724.190815|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:25.263360|1725389725.2633698|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:25.342798|1725389725.342808|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:26.414125|1725389726.414134|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:26.493850|1725389726.493858|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:27.558505|1725389727.5585148|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:27.638612|1725389727.6386402|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:28.709742|1725389728.7097533|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:28.789272|1725389728.7892802|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:29.859034|1725389729.8590672|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:29.938630|1725389729.938639|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:31.008197|1725389731.008206|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:31.087445|1725389731.0874538|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:32.157670|1725389732.1576786|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:32.237216|1725389732.2372248|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:33.309097|1725389733.3091059|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:33.388632|1725389733.3886404|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:34.458778|1725389734.458787|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:34.538432|1725389734.5384417|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:35.610129|1725389735.6101384|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:35.689345|1725389735.6893528|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:36.761090|1725389736.7610989|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:36.840709|1725389736.8407173|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:37.912609|1725389737.9126182|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:37.991986|1725389737.991994|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:39.064996|1725389739.065005|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:39.144389|1725389739.1443975|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:40.217099|1725389740.217108|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:40.296495|1725389740.296505|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:41.366220|1725389741.3662307|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:41.445628|1725389741.445638|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:42.519084|1725389742.5190933|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:42.598476|1725389742.5984838|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:43.670279|1725389743.6702883|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:43.749801|1725389743.7498097|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:44.820016|1725389744.8200262|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:44.899606|1725389744.8996148|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:45.971170|1725389745.971179|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:46.115185|1725389746.115195|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:47.117244|1725389747.1172526|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:47.261594|1725389747.2616022|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:48.266783|1725389748.2667918|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:48.409954|1725389748.409963|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:49.414900|1725389749.414908|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:49.555369|1725389749.5553775|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:50.635109|1725389750.635119|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:50.714724|1725389750.7147331|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:51.786886|1725389751.7868946|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:51.866415|1725389751.866423|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:52.938977|1725389752.9389858|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:53.018881|1725389753.0188901|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:54.088919|1725389754.08893|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:54.168666|1725389754.1686742|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:55.240493|1725389755.240502|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:55.320188|1725389755.3202133|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:56.390961|1725389756.3909693|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:56.470222|1725389756.4702303|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:57.540370|1725389757.5403807|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:57.619943|1725389757.6199527|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:58.690202|1725389758.6902113|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:58.769877|1725389758.7698848|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:59.841566|1725389759.8415756|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:55:59.921071|1725389759.921081|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:00.992400|1725389760.9924092|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:01.072160|1725389761.072169|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:02.143559|1725389762.143568|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:02.223122|1725389762.2231352|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:03.290522|1725389763.2905312|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:03.369995|1725389763.3700035|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:04.442142|1725389764.4421506|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:04.521997|1725389764.5220065|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:05.593798|1725389765.5938065|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:05.673169|1725389765.673177|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:06.743793|1725389766.743803|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:06.823590|1725389766.8235996|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:07.894938|1725389767.8949468|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:07.974436|1725389767.9744444|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:09.045243|1725389769.0452518|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:09.124742|1725389769.124752|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:10.191860|1725389770.1918702|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:10.271363|1725389770.2713711|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:11.343876|1725389771.343885|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:11.423287|1725389771.423297|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:12.494384|1725389772.4943922|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:12.574238|1725389772.5742462|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:13.645873|1725389773.6458828|Exception parsing instruction,HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 135, in forward
    out2 = self.down1(out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 59, in forward
    out3 = self.conv2(out2)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 158.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 6.26 GiB is allocated by PyTorch, and 206.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-03 18:56:13.725621|1725389773.7256303|Exception parsing instruction,HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables),Traceback (most recent call last):
  File "/opt/root_painter/trainer/trainer.py", line 178, in execute_instruction
    getattr(self, name)(config)
  File "/opt/root_painter/trainer/trainer.py", line 466, in segment
    self.segment_file(in_dir, seg_dir, fname,
  File "/opt/root_painter/trainer/trainer.py", line 554, in segment_file
    seg_maps = ensemble_segment(model_paths, photo, self.bs,
  File "/opt/root_painter/trainer/model_utils.py", line 245, in ensemble_segment
    pred_maps = unet_segment(cnn, image,
  File "/opt/root_painter/trainer/model_utils.py", line 305, in unet_segment
    outputs = cnn(gpu_tiles)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 184, in forward
    return self.module(*inputs[0], **module_kwargs[0])
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 142, in forward
    out = self.up4(out, out1)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter/trainer/unet.py", line 103, in forward
    out = self.conv3(out)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 104, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/root_painter_env/lib/python3.10/site-packages/torch/nn/functional.py", line 1500, in relu
    result = torch.relu(input)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 246.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 92.00 MiB is free. Of the allocated memory 8.65 GiB is allocated by PyTorch, and 308.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

